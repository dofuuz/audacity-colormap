
from matplotlib.colors import ListedColormap, LinearSegmentedColormap

cm_type = "linear"

cm_data = [[1.55713838e-03,1.06275571e-03,2.01425700e-03],
           [2.96008772e-03,1.94080297e-03,2.66615397e-03],
           [4.94841946e-03,2.97571079e-03,3.27586187e-03],
           [7.54004080e-03,4.16611623e-03,3.65993569e-03],
           [1.06586852e-02,5.52589272e-03,3.88027829e-03],
           [1.43057944e-02,7.04183588e-03,3.98648087e-03],
           [1.86539904e-02,8.63347520e-03,4.04817828e-03],
           [2.39380763e-02,1.01976442e-02,4.13240913e-03],
           [3.02166456e-02,1.17000389e-02,4.30511636e-03],
           [3.74881467e-02,1.31315204e-02,4.61905244e-03],
           [4.54517501e-02,1.44964830e-02,5.10183561e-03],
           [5.34043941e-02,1.58022200e-02,5.76361546e-03],
           [6.13080355e-02,1.70506399e-02,6.60920292e-03],
           [6.91578232e-02,1.82391405e-02,7.64341762e-03],
           [7.69602239e-02,1.93601091e-02,8.87297732e-03],
           [8.47186949e-02,2.04080830e-02,1.03011746e-02],
           [9.24421317e-02,2.13734460e-02,1.19350858e-02],
           [1.00138494e-01,2.22461379e-02,1.37825421e-02],
           [1.07790596e-01,2.30278691e-02,1.59124530e-02],
           [1.15329859e-01,2.37503122e-02,1.85449486e-02],
           [1.22744418e-01,2.44218928e-02,2.17952357e-02],
           [1.30008641e-01,2.50676031e-02,2.57816806e-02],
           [1.37091837e-01,2.57205558e-02,3.06515421e-02],
           [1.43990921e-01,2.63981349e-02,3.64983916e-02],
           [1.50706344e-01,2.71150195e-02,4.33057220e-02],
           [1.57237043e-01,2.78854487e-02,5.05709859e-02],
           [1.63588678e-01,2.87162149e-02,5.82090000e-02],
           [1.69788303e-01,2.95958767e-02,6.61266986e-02],
           [1.75830526e-01,3.05331609e-02,7.43538651e-02],
           [1.81749837e-01,3.15043560e-02,8.27964506e-02],
           [1.87551412e-01,3.25050802e-02,9.14606223e-02],
           [1.93246672e-01,3.35238523e-02,1.00335376e-01],
           [1.98857954e-01,3.45377870e-02,1.09380179e-01],
           [2.04395010e-01,3.55330515e-02,1.18588943e-01],
           [2.09863956e-01,3.64952504e-02,1.27973425e-01],
           [2.15274418e-01,3.74061566e-02,1.37530888e-01],
           [2.20640421e-01,3.82427033e-02,1.47243826e-01],
           [2.25970336e-01,3.89829725e-02,1.57116939e-01],
           [2.31271585e-01,3.96054316e-02,1.67152476e-01],
           [2.36551151e-01,4.00873081e-02,1.77353352e-01],
           [2.41816063e-01,4.04023603e-02,1.87726588e-01],
           [2.47064006e-01,4.05483066e-02,1.98254344e-01],
           [2.52286775e-01,4.05248202e-02,2.08959291e-01],
           [2.57480724e-01,4.03195056e-02,2.19857020e-01],
           [2.62640937e-01,3.99229129e-02,2.30958044e-01],
           [2.67760802e-01,3.93369911e-02,2.42263393e-01],
           [2.72833740e-01,3.85604467e-02,2.53779001e-01],
           [2.77852345e-01,3.75950906e-02,2.65508785e-01],
           [2.82808142e-01,3.64483405e-02,2.77451928e-01],
           [2.87692241e-01,3.51287017e-02,2.89609330e-01],
           [2.92494697e-01,3.36512876e-02,3.01976929e-01],
           [2.97205117e-01,3.20327101e-02,3.14552665e-01],
           [3.01794145e-01,3.03577612e-02,3.27304877e-01],
           [3.06257482e-01,2.86356747e-02,3.40232230e-01],
           [3.10588101e-01,2.68865506e-02,3.53328506e-01],
           [3.14772258e-01,2.51594687e-02,3.66574210e-01],
           [3.18794771e-01,2.35120889e-02,3.79949036e-01],
           [3.22602554e-01,2.21568102e-02,3.93373895e-01],
           [3.26216525e-01,2.10404924e-02,4.06865565e-01],
           [3.29622188e-01,2.02448407e-02,4.20392024e-01],
           [3.32784711e-01,1.99444927e-02,4.33888246e-01],
           [3.35681205e-01,2.02806015e-02,4.47301984e-01],
           [3.38326946e-01,2.12432165e-02,4.60632025e-01],
           [3.40704171e-01,2.29633105e-02,4.73829623e-01],
           [3.42763673e-01,2.57199790e-02,4.86799168e-01],
           [3.44543480e-01,2.94143837e-02,4.99570731e-01],
           [3.46038132e-01,3.41368928e-02,5.12111699e-01],
           [3.47204127e-01,4.01524813e-02,5.24338233e-01],
           [3.48071069e-01,4.69639462e-02,5.36270766e-01],
           [3.48651198e-01,5.41846257e-02,5.47920125e-01],
           [3.48925513e-01,6.18109137e-02,5.59239658e-01],
           [3.48854447e-01,6.99215993e-02,5.70124802e-01],
           [3.48467622e-01,7.83057771e-02,5.80631715e-01],
           [3.47760205e-01,8.69265824e-02,5.90735316e-01],
           [3.46698789e-01,9.58448490e-02,6.00344802e-01],
           [3.45297153e-01,1.04960813e-01,6.09478415e-01],
           [3.43570545e-01,1.14190076e-01,6.18163573e-01],
           [3.41520754e-01,1.23503114e-01,6.26395446e-01],
           [3.39114340e-01,1.32960346e-01,6.34088732e-01],
           [3.36388104e-01,1.42442375e-01,6.41329462e-01],
           [3.33349507e-01,1.51917855e-01,6.48137111e-01],
           [3.30003617e-01,1.61366954e-01,6.54524342e-01],
           [3.26346611e-01,1.70784731e-01,6.60495054e-01],
           [3.22364596e-01,1.80183881e-01,6.66030520e-01],
           [3.18084678e-01,1.89503636e-01,6.71209201e-01],
           [3.13505072e-01,1.98736365e-01,6.76053683e-01],
           [3.08624937e-01,2.07874462e-01,6.80586767e-01],
           [3.03440056e-01,2.16912778e-01,6.84831934e-01],
           [2.97944165e-01,2.25847417e-01,6.88812688e-01],
           [2.92127747e-01,2.34676039e-01,6.92552357e-01],
           [2.85974948e-01,2.43398923e-01,6.96073814e-01],
           [2.79475882e-01,2.52012594e-01,6.99399219e-01],
           [2.72600026e-01,2.60522077e-01,7.02549915e-01],
           [2.65330151e-01,2.68924640e-01,7.05546658e-01],
           [2.57623461e-01,2.77226422e-01,7.08408632e-01],
           [2.49431873e-01,2.85432229e-01,7.11153779e-01],
           [2.40828688e-01,2.93715648e-01,7.13027186e-01],
           [2.31898782e-01,3.02073301e-01,7.13866747e-01],
           [2.22731275e-01,3.10447734e-01,7.13730201e-01],
           [2.13427123e-01,3.18782069e-01,7.12701955e-01],
           [2.04074291e-01,3.27030206e-01,7.10879601e-01],
           [1.94768105e-01,3.35150132e-01,7.08375261e-01],
           [1.85584351e-01,3.43113016e-01,7.05298804e-01],
           [1.76604238e-01,3.50893960e-01,7.01766088e-01],
           [1.67953235e-01,3.58499188e-01,6.97737311e-01],
           [1.59698339e-01,3.65909778e-01,6.93354782e-01],
           [1.51843792e-01,3.73115266e-01,6.88783316e-01],
           [1.44434492e-01,3.80116073e-01,6.84107967e-01],
           [1.37511465e-01,3.86923568e-01,6.79361525e-01],
           [1.31347342e-01,3.93561943e-01,6.74352795e-01],
           [1.25734614e-01,4.00017859e-01,6.69408736e-01],
           [1.20671896e-01,4.06301814e-01,6.64578858e-01],
           [1.16468823e-01,4.12441241e-01,6.59620378e-01],
           [1.12932643e-01,4.18433121e-01,6.54760422e-01],
           [1.09918577e-01,4.24286801e-01,6.50107253e-01],
           [1.07904289e-01,4.30023875e-01,6.45330048e-01],
           [1.06381911e-01,4.35644026e-01,6.40777072e-01],
           [1.05483079e-01,4.41161815e-01,6.36331743e-01],
           [1.05299030e-01,4.46586499e-01,6.31923883e-01],
           [1.05374732e-01,4.51925545e-01,6.27788902e-01],
           [1.06295092e-01,4.57187359e-01,6.23569625e-01],
           [1.07285635e-01,4.62383325e-01,6.19641886e-01],
           [1.08876076e-01,4.67516573e-01,6.15699347e-01],
           [1.10519787e-01,4.72598845e-01,6.11986589e-01],
           [1.12537347e-01,4.77632817e-01,6.08307880e-01],
           [1.14555239e-01,4.82629847e-01,6.04813051e-01],
           [1.16794299e-01,4.87591629e-01,6.01364195e-01],
           [1.18939680e-01,4.92529527e-01,5.98080410e-01],
           [1.21223792e-01,4.97442825e-01,5.94827981e-01],
           [1.23292340e-01,5.02344317e-01,5.91746125e-01],
           [1.25470056e-01,5.07231348e-01,5.88647811e-01],
           [1.27296724e-01,5.12116335e-01,5.85754127e-01],
           [1.29249463e-01,5.16994953e-01,5.82776539e-01],
           [1.30767026e-01,5.21882219e-01,5.79991446e-01],
           [1.32318311e-01,5.26770239e-01,5.77136294e-01],
           [1.33487952e-01,5.31672337e-01,5.74401662e-01],
           [1.34485612e-01,5.36586306e-01,5.71656255e-01],
           [1.35224048e-01,5.41517041e-01,5.68922270e-01],
           [1.35586604e-01,5.46468767e-01,5.66249652e-01],
           [1.35832993e-01,5.51437357e-01,5.63476871e-01],
           [1.35588891e-01,5.56433820e-01,5.60782172e-01],
           [1.35183230e-01,5.61451235e-01,5.57972719e-01],
           [1.34366207e-01,5.66497529e-01,5.55154545e-01],
           [1.33160376e-01,5.71570449e-01,5.52320819e-01],
           [1.31727729e-01,5.76669376e-01,5.49339856e-01],
           [1.29772962e-01,5.81799591e-01,5.46365424e-01],
           [1.27547118e-01,5.86956196e-01,5.43237851e-01],
           [1.24894686e-01,5.92142011e-01,5.40021758e-01],
           [1.21705538e-01,5.97356679e-01,5.36772495e-01],
           [1.18277114e-01,6.02598479e-01,5.33263394e-01],
           [1.14123365e-01,6.07883102e-01,5.29621686e-01],
           [1.09494788e-01,6.13192238e-01,5.25831137e-01],
           [1.04816333e-01,6.18494855e-01,5.21947189e-01],
           [9.91218846e-02,6.23853930e-01,5.17798220e-01],
           [9.35008454e-02,6.29194809e-01,5.13557106e-01],
           [8.72417232e-02,6.34559797e-01,5.09104351e-01],
           [8.00954440e-02,6.39956180e-01,5.04402421e-01],
           [7.33159791e-02,6.45316400e-01,4.99616518e-01],
           [6.50437683e-02,6.50727563e-01,4.94487151e-01],
           [5.71309606e-02,6.56101547e-01,4.89249332e-01],
           [4.81652669e-02,6.61493811e-01,4.83728995e-01],
           [3.84893768e-02,6.66882842e-01,4.77975483e-01],
           [2.96388543e-02,6.72246159e-01,4.72024694e-01],
           [2.04999901e-02,6.77633028e-01,4.65725298e-01],
           [1.42394972e-02,6.82955878e-01,4.59309691e-01],
           [7.38376983e-03,6.88313412e-01,4.52473626e-01],
           [4.21250722e-03,6.93589184e-01,4.45544671e-01],
           [8.81907330e-04,6.98891740e-01,4.38158003e-01],
           [1.32737259e-03,7.04114414e-01,4.30650919e-01],
           [2.37844839e-03,7.09346595e-01,4.22690105e-01],
           [7.63084795e-03,7.14494417e-01,4.14568596e-01],
           [1.39342746e-02,7.19644375e-01,4.05954554e-01],
           [2.54054341e-02,7.24690244e-01,3.97213890e-01],
           [3.82584801e-02,7.29734792e-01,3.87919899e-01],
           [5.53119228e-02,7.34658627e-01,3.78492226e-01],
           [7.10737984e-02,7.39555185e-01,3.68523438e-01],
           [8.76597618e-02,7.44352370e-01,3.58267030e-01],
           [1.04402500e-01,7.49067133e-01,3.47591572e-01],
           [1.20906630e-01,7.53717968e-01,3.36355204e-01],
           [1.38604364e-01,7.58212804e-01,3.24939711e-01],
           [1.56133691e-01,7.62626145e-01,3.12905817e-01],
           [1.73930194e-01,7.66926004e-01,3.00304080e-01],
           [1.92594078e-01,7.71047960e-01,2.87432810e-01],
           [2.11444203e-01,7.75039899e-01,2.73893783e-01],
           [2.30593674e-01,7.78882367e-01,2.59703819e-01],
           [2.50390333e-01,7.82525079e-01,2.45026764e-01],
           [2.70766175e-01,7.85956098e-01,2.29843918e-01],
           [2.91528169e-01,7.89182954e-01,2.13988722e-01],
           [3.12720996e-01,7.92184976e-01,1.97443709e-01],
           [3.34319317e-01,7.94947148e-01,1.80247141e-01],
           [3.56292465e-01,7.97456328e-01,1.62415221e-01],
           [3.78551778e-01,7.99708276e-01,1.44007741e-01],
           [4.01014343e-01,8.01700838e-01,1.25132005e-01],
           [4.23562653e-01,8.03441204e-01,1.05967328e-01],
           [4.46002693e-01,8.04959725e-01,8.64988420e-02],
           [4.68197336e-01,8.06282812e-01,6.68689088e-02],
           [4.90019314e-01,8.07442214e-01,4.72723060e-02],
           [5.11369338e-01,8.08470603e-01,2.89448253e-02],
           [5.32163299e-01,8.09402495e-01,1.60169431e-02],
           [5.52365240e-01,8.10265457e-01,8.52034000e-03],
           [5.71951868e-01,8.11085657e-01,5.99097057e-03],
           [5.91217666e-01,8.11809943e-01,7.57325931e-03],
           [6.09908719e-01,8.12526827e-01,1.16453295e-02],
           [6.28049722e-01,8.13242852e-01,1.86750758e-02],
           [6.45705951e-01,8.13954560e-01,2.86890246e-02],
           [6.62891804e-01,8.14668165e-01,4.21055308e-02],
           [6.79595415e-01,8.15397015e-01,5.71722223e-02],
           [6.95823303e-01,8.16148512e-01,7.28589507e-02],
           [7.11541086e-01,8.16942868e-01,8.91295102e-02],
           [7.26736706e-01,8.17793393e-01,1.05979160e-01],
           [7.41368927e-01,8.18723628e-01,1.23388912e-01],
           [7.55402346e-01,8.19756000e-01,1.41341944e-01],
           [7.68783623e-01,8.20919149e-01,1.59864463e-01],
           [7.81437385e-01,8.22249694e-01,1.79012483e-01],
           [7.93380784e-01,8.23757329e-01,1.98562988e-01],
           [8.04592672e-01,8.25462694e-01,2.18447247e-01],
           [8.15065675e-01,8.27381356e-01,2.38593715e-01],
           [8.24805329e-01,8.29523718e-01,2.58927405e-01],
           [8.33832580e-01,8.31893296e-01,2.79382683e-01],
           [8.42177872e-01,8.34489003e-01,2.99893537e-01],
           [8.49883269e-01,8.37303451e-01,3.20413627e-01],
           [8.56992504e-01,8.40328017e-01,3.40883978e-01],
           [8.63558093e-01,8.43547984e-01,3.61285474e-01],
           [8.69628271e-01,8.46950555e-01,3.81571934e-01],
           [8.75254143e-01,8.50519495e-01,4.01732109e-01],
           [8.80483044e-01,8.54239875e-01,4.21744808e-01],
           [8.85359971e-01,8.58097070e-01,4.41592318e-01],
           [8.89927208e-01,8.62077118e-01,4.61258740e-01],
           [8.94223899e-01,8.66166566e-01,4.80737487e-01],
           [8.98286530e-01,8.70353431e-01,5.00011728e-01],
           [9.02122504e-01,8.74633417e-01,5.19132037e-01],
           [9.05711239e-01,8.79011539e-01,5.38173036e-01],
           [9.09150299e-01,8.83457553e-01,5.57000863e-01],
           [9.12465247e-01,8.87962666e-01,5.75614793e-01],
           [9.15608437e-01,8.92522573e-01,5.94382079e-01],
           [9.18821665e-01,8.97071452e-01,6.12839336e-01],
           [9.22091262e-01,9.01608099e-01,6.31113024e-01],
           [9.25419110e-01,9.06133701e-01,6.49198771e-01],
           [9.28805528e-01,9.10649215e-01,6.67103572e-01],
           [9.32258594e-01,9.15157728e-01,6.84765146e-01],
           [9.35775742e-01,9.19659939e-01,7.02210952e-01],
           [9.39352743e-01,9.24155781e-01,7.19483484e-01],
           [9.42991651e-01,9.28646930e-01,7.36569308e-01],
           [9.46690873e-01,9.33133891e-01,7.53487320e-01],
           [9.50453705e-01,9.37618905e-01,7.70211102e-01],
           [9.54278100e-01,9.42102229e-01,7.86763602e-01],
           [9.58165656e-01,9.46585454e-01,8.03134036e-01],
           [9.62115458e-01,9.51068983e-01,8.19336684e-01],
           [9.66131940e-01,9.55555681e-01,8.35333832e-01],
           [9.70217162e-01,9.60047374e-01,8.51111419e-01],
           [9.74362758e-01,9.64539425e-01,8.66769807e-01],
           [9.78584125e-01,9.69040410e-01,8.82163474e-01],
           [9.82872488e-01,9.73543488e-01,8.97416021e-01],
           [9.87237781e-01,9.78051963e-01,9.12462972e-01],
           [9.91681300e-01,9.82559934e-01,9.27371591e-01],
           [9.96185536e-01,9.87032423e-01,9.42573305e-01]]

cm_simplified = [
    (0, 0, 0),
    (80/256, 0, 80/256),
    (32/256, 80/256, 176/256),
    (0/256, 160/256, 144/256),
    (192/256, 208/256, 0/256),
    (256/256,  256/256, 256/256),
    ]

cm_simplified = [
    (0, 0, 0),
    (48/256, 0, 16/256),
    (80/256, 0/256, 128/256),
    (48/256, 64/256, 176/256),
    (16/256, 128/256, 160/256),
    (0/256, 176/256, 128/256),
    (112/256, 208/256, 0/256),
    (224/256, 224/256, 112/256),
    (256/256, 256/256, 256/256),
    ]

seg_simple = len(cm_simplified)-1

test_cm = ListedColormap(cm_data, name="vividis53")
# test_cm = LinearSegmentedColormap.from_list("vividis53_simplified", cm_simplified)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                    cmap=test_cm)
    plt.show()

    plt.figure()
    fix, ax = plt.subplots()
    plt.plot(np.asarray(cm_data)*256)
    plt.plot(np.mean(np.asarray(cm_data)*256, axis=1))
    plt.plot(np.arange(0, 257, 256/seg_simple), np.asarray(cm_simplified)*256)
    plt.plot(np.arange(0, 257, 256/seg_simple), np.mean(np.asarray(cm_simplified)*256, axis=1))
    ax.set_xticks(np.arange(0, 256, 256/seg_simple))
    ax.set_yticks(np.arange(0, 256, 16))
    
    ax.grid(which='both')
    plt.show()
